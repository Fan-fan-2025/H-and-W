<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœå†» & å“†å’ª ç”Ÿé•¿å‘è‚²æ›²çº¿</title>
    <!-- ä½¿ç”¨å›½å†…å¯è®¿é—®çš„Chart.jsé•œåƒ -->
    <script src="https://cdn.bootcdn.net/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(550px, 1fr));
            gap: 30px;
            padding: 30px;
        }
        
        .chart-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #eaeaea;
        }
        
        .chart-card h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            font-size: 1.5rem;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .data-table th {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 12px;
            text-align: center;
        }
        
        .data-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .status-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
        }
        
        .status-normal {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-overweight {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-obese {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .summary {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 30px;
            margin-top: 20px;
            border-radius: 15px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        .summary-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .summary-value {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
            margin: 10px 0;
        }
        
        .boy-color { color: #3498db; }
        .girl-color { color: #e84393; }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
                padding: 15px;
            }
            
            .chart-card {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‘¦ æœå†» & ğŸ‘§ å“†å’ª ç”Ÿé•¿å‘è‚²æ›²çº¿</h1>
            <p>è®°å½•æ—¶é—´ï¼š2023å¹´3æœˆ è‡³ 2025å¹´7æœˆ | æ•°æ®è‡ªåŠ¨åˆ†æ</p>
        </div>
        
        <div class="charts-grid">
            <!-- èº«é«˜å¢é•¿æ›²çº¿ -->
            <div class="chart-card">
                <h2>ğŸ“ˆ èº«é«˜å¢é•¿æ›²çº¿</h2>
                <div class="chart-container">
                    <canvas id="heightChart"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <span class="color-dot" style="background-color: #3498db;"></span>
                        <span class="boy-color">æœå†»ï¼ˆå„¿å­ï¼‰</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-dot" style="background-color: #e84393;"></span>
                        <span class="girl-color">å“†å’ªï¼ˆå¥³å„¿ï¼‰</span>
                    </div>
                </div>
            </div>
            
            <!-- BMIå˜åŒ–æ›²çº¿ -->
            <div class="chart-card">
                <h2>âš–ï¸ BMIå˜åŒ–æ›²çº¿</h2>
                <div class="chart-container">
                    <canvas id="bmiChart"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <span class="color-dot" style="background-color: #2ecc71;"></span>
                        <span>æ­£å¸¸èŒƒå›´</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-dot" style="background-color: #f39c12;"></span>
                        <span>è¶…é‡è­¦æˆ’çº¿</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-dot" style="background-color: #e74c3c;"></span>
                        <span>è‚¥èƒ–è­¦æˆ’çº¿</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ•°æ®è¡¨æ ¼ -->
        <div class="chart-card" style="margin: 0 30px 30px 30px;">
            <h2>ğŸ“‹ è¯¦ç»†æ•°æ®è®°å½•</h2>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>æ—¥æœŸ</th>
                        <th>å­©å­</th>
                        <th>èº«é«˜(cm)</th>
                        <th>ä½“é‡(kg)</th>
                        <th>BMI</th>
                        <th>ä½“é‡çŠ¶å†µ</th>
                        <th>æ¯”ä¸Šæ¬¡å˜åŒ–</th>
                    </tr>
                </thead>
                <tbody id="dataTable">
                    <!-- æ•°æ®ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>
        
        <!-- æˆé•¿æ€»ç»“ -->
        <div class="summary">
            <h2 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“Š æˆé•¿æ€»ç»“</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <h3 class="boy-color">æœå†»ï¼ˆå„¿å­ï¼‰</h3>
                    <div class="summary-value">14.3cm</div>
                    <p>èº«é«˜æ€»å¢é•¿</p>
                    <div class="summary-value">14.8kg</div>
                    <p>ä½“é‡æ€»å¢é•¿</p>
                    <div style="margin-top: 15px;">
                        <span class="status-indicator status-overweight">éœ€å…³æ³¨ä½“é‡</span>
                    </div>
                </div>
                
                <div class="summary-card">
                    <h3 class="girl-color">å“†å’ªï¼ˆå¥³å„¿ï¼‰</h3>
                    <div class="summary-value">12.0cm</div>
                    <p>èº«é«˜æ€»å¢é•¿</p>
                    <div class="summary-value">8.0kg</div>
                    <p>ä½“é‡æ€»å¢é•¿</p>
                    <div style="margin-top: 15px;">
                        <span class="status-indicator status-normal">ç”Ÿé•¿å‘è‚²è‰¯å¥½</span>
                    </div>
                </div>
                
                <div class="summary-card">
                    <h3>ğŸ† æˆé•¿é€Ÿåº¦</h3>
                    <div class="summary-value">6.8 cm/å¹´</div>
                    <p>æœå†»èº«é«˜å¢é€Ÿ</p>
                    <div class="summary-value">7.2 cm/å¹´</div>
                    <p>å“†å’ªèº«é«˜å¢é€Ÿ</p>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9rem;">*å‡å¤„äºæ­£å¸¸ç”Ÿé•¿èŒƒå›´</p>
                </div>
                
                <div class="summary-card">
                    <h3>ğŸ“… ç›‘æµ‹é¢‘ç‡</h3>
                    <div class="summary-value">23æ¬¡</div>
                    <p>æ€»è®°å½•æ¬¡æ•°</p>
                    <div class="summary-value">1.2 æœˆ/æ¬¡</div>
                    <p>å¹³å‡ç›‘æµ‹é—´éš”</p>
                    <p style="margin-top: 10px; color: #27ae60; font-size: 0.9rem;">âœ“ ç›‘æµ‹é¢‘ç‡è‰¯å¥½</p>
                </div>
            </div>
            
            <div style="margin-top: 25px; padding: 20px; background: white; border-radius: 10px; border-left: 4px solid #3498db;">
                <h4 style="color: #2c3e50; margin-bottom: 10px;">ğŸ’¡ å¥åº·å»ºè®®</h4>
                <p style="color: #666; line-height: 1.8;">
                    1. <strong>æœå†»</strong>çš„BMIæŒ‡æ•°æŒç»­åé«˜ï¼Œå»ºè®®é€‚å½“å¢åŠ ä½“è‚²æ´»åŠ¨æ—¶é—´ï¼Œä¿æŒæ¯å¤©è‡³å°‘1å°æ—¶ä¸­ç­‰å¼ºåº¦è¿åŠ¨ã€‚<br>
                    2. <strong>å“†å’ª</strong>ç”Ÿé•¿å‘è‚²çŠ¶å†µè‰¯å¥½ï¼Œç»§ç»­ä¿æŒå‡è¡¡é¥®é£Ÿå’Œè§„å¾‹ä½œæ¯ã€‚<br>
                    3. ä¸¤ä¸ªå­©å­èº«é«˜å¢é•¿å‡å¤„äºæ­£å¸¸èŒƒå›´ï¼Œå»ºè®®ç»§ç»­å®šæœŸç›‘æµ‹ï¼Œæ¯3-6ä¸ªæœˆè®°å½•ä¸€æ¬¡ã€‚<br>
                    4. å…³æ³¨é¥®é£Ÿç»“æ„ï¼Œç¡®ä¿è›‹ç™½è´¨ã€é’™è´¨å’Œç»´ç”Ÿç´ çš„å……è¶³æ‘„å…¥ã€‚
                </p>
            </div>
        </div>
    </div>

    <script>
        // æ•°æ®å®šä¹‰
        const growthData = {
            guodong: [
                { date: '2023-03-20', height: 130.7, weight: 36.0 },
                { date: '2023-05-20', height: 130.8, weight: 36.6 },
                { date: '2023-07-06', height: 132.5, weight: 36.6 },
                { date: '2023-08-19', height: 134.0, weight: 38.3 },
                { date: '2023-10-03', height: 135.0, weight: 37.0 },
                { date: '2023-12-02', height: 135.0, weight: 37.2 },
                { date: '2024-03-06', height: 136.5, weight: 39.3 },
                { date: '2024-05-11', height: 137.0, weight: 40.3 },
                { date: '2024-07-29', height: 138.0, weight: 42.5 },
                { date: '2024-08-16', height: 138.0, weight: 43.5 },
                { date: '2024-12-02', height: 140.0, weight: 44.0 },
                { date: '2025-01-15', height: 142.0, weight: 44.0 },
                { date: '2025-03-03', height: 143.0, weight: 46.7 },
                { date: '2025-07-05', height: 144.0, weight: 47.8 },
                { date: '2025-10-07', height: 145.0, weight: 50.8 }
            ],
            duomi: [
                { date: '2023-08-19', height: 114.0, weight: 22.3 },
                { date: '2024-06-01', height: 118.0, weight: 25.8 },
                { date: '2024-06-15', height: 118.5, weight: 26.3 },
                { date: '2024-07-29', height: 119.0, weight: 27.1 },
                { date: '2024-08-19', height: 119.5, weight: 27.1 },
                { date: '2024-10-18', height: 121.0, weight: 28.1 },
                { date: '2025-01-15', height: 123.0, weight: 29.4 },
                { date: '2025-03-03', height: 124.0, weight: 29.9 },
                { date: '2025-06-02', height: 126.0, weight: 30.3 }
            ]
        };

        // å¤„ç†æ•°æ®ï¼šè®¡ç®—BMIå’Œè¯„ä¼°çŠ¶æ€
        function processData(childData, childName) {
            return childData.map((record, index) => {
                const bmi = record.weight / ((record.height/100) ** 2);
                const bmiRounded = Math.round(bmi * 10) / 10;
                
                // ç®€åŒ–çš„BMIè¯„ä¼°ï¼ˆæ ¹æ®ä¸­å›½å„¿ç«¥æ ‡å‡†ï¼‰
                let status, statusClass;
                if (childName === 'æœå†»') {
                    // ç”·å­©æ ‡å‡†
                    if (bmi < 14.5) { status = 'æ¶ˆç˜¦'; statusClass = 'status-normal'; }
                    else if (bmi < 17.5) { status = 'æ­£å¸¸'; statusClass = 'status-normal'; }
                    else if (bmi < 19.5) { status = 'è¶…é‡'; statusClass = 'status-overweight'; }
                    else { status = 'è‚¥èƒ–'; statusClass = 'status-obese'; }
                } else {
                    // å¥³å­©æ ‡å‡†
                    if (bmi < 14) { status = 'æ¶ˆç˜¦'; statusClass = 'status-normal'; }
                    else if (bmi < 17) { status = 'æ­£å¸¸'; statusClass = 'status-normal'; }
                    else if (bmi < 18.5) { status = 'è¶…é‡'; statusClass = 'status-overweight'; }
                    else { status = 'è‚¥èƒ–'; statusClass = 'status-obese'; }
                }
                
                // è®¡ç®—å˜åŒ–
                let change = '';
                if (index > 0) {
                    const prevHeight = childData[index-1].height;
                    const heightChange = record.height - prevHeight;
                    const monthsDiff = (new Date(record.date) - new Date(childData[index-1].date)) / (1000*60*60*24*30);
                    if (monthsDiff > 0) {
                        const yearlyRate = (heightChange / monthsDiff * 12).toFixed(1);
                        change = `â†‘${heightChange.toFixed(1)}cm (${yearlyRate}cm/å¹´)`;
                    }
                }
                
                return {
                    ...record,
                    bmi: bmiRounded,
                    status,
                    statusClass,
                    change: change || 'é¦–æ¬¡è®°å½•'
                };
            });
        }

        const guodongProcessed = processData(growthData.guodong, 'æœå†»');
        const duomiProcessed = processData(growthData.duomi, 'å“†å’ª');

        // å¡«å……æ•°æ®è¡¨æ ¼
        const tableBody = document.getElementById('dataTable');
        
        // åˆå¹¶å¹¶æŒ‰æ—¥æœŸæ’åº
        const allRecords = [...guodongProcessed.map(r => ({...r, child: 'æœå†»'})), 
                           ...duomiProcessed.map(r => ({...r, child: 'å“†å’ª'}))];
        
        allRecords.sort((a, b) => new Date(a.date) - new Date(b.date));
        
        allRecords.forEach(record => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${record.date}</td>
                <td><strong class="${record.child === 'æœå†»' ? 'boy-color' : 'girl-color'}">${record.child}</strong></td>
                <td>${record.height}</td>
                <td>${record.weight}</td>
                <td><strong>${record.bmi}</strong></td>
                <td><span class="status-indicator ${record.statusClass}">${record.status}</span></td>
                <td>${record.change}</td>
            `;
            tableBody.appendChild(row);
        });

        // åˆ›å»ºå›¾è¡¨
        function createChart(canvasId, type, labels, datasets, options = {}) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            
            const defaultOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleFont: { size: 14 },
                        bodyFont: { size: 13 },
                        padding: 12,
                        cornerRadius: 6
                    }
                },
                scales: {
                    x: {
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        }
                    },
                    y: {
                        beginAtZero: false,
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        }
                    }
                }
            };
            
            const finalOptions = {...defaultOptions, ...options};
            
            return new Chart(ctx, {
                type: type,
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: finalOptions
            });
        }

        // èº«é«˜å›¾è¡¨
        const heightLabels = guodongProcessed.map(r => r.date.substring(0, 7));
        
        createChart('heightChart', 'line', heightLabels, [
            {
                label: 'æœå†»èº«é«˜',
                data: guodongProcessed.map(r => r.height),
                borderColor: '#3498db',
                backgroundColor: 'rgba(52, 152, 219, 0.1)',
                borderWidth: 3,
                tension: 0.3,
                fill: true,
                pointBackgroundColor: '#3498db',
                pointRadius: 6,
                pointHoverRadius: 10
            },
            {
                label: 'å“†å’ªèº«é«˜',
                data: duomiProcessed.map(r => r.height),
                borderColor: '#e84393',
                backgroundColor: 'rgba(232, 67, 147, 0.1)',
                borderWidth: 3,
                tension: 0.3,
                fill: true,
                pointBackgroundColor: '#e84393',
                pointRadius: 6,
                pointHoverRadius: 10
            }
        ], {
            plugins: {
                title: {
                    display: true,
                    text: 'èº«é«˜å¢é•¿è¶‹åŠ¿ (cm)',
                    font: { size: 16 }
                }
            },
            scales: {
                y: {
                    title: {
                        display: true,
                        text: 'èº«é«˜ (cm)'
                    }
                }
            }
        });

        // BMIå›¾è¡¨
        const bmiLabels = guodongProcessed.map(r => r.date.substring(0, 7));
        
        createChart('bmiChart', 'line', bmiLabels, [
            {
                label: 'æœå†»BMI',
                data: guodongProcessed.map(r => r.bmi),
                borderColor: '#3498db',
                backgroundColor: 'rgba(52, 152, 219, 0.1)',
                borderWidth: 3,
                tension: 0.3,
                fill: false,
                pointBackgroundColor: '#3498db',
                pointRadius: 6,
                pointHoverRadius: 10
            },
            {
                label: 'å“†å’ªBMI',
                data: duomiProcessed.map(r => r.bmi),
                borderColor: '#e84393',
                backgroundColor: 'rgba(232, 67, 147, 0.1)',
                borderWidth: 3,
                tension: 0.3,
                fill: false,
                pointBackgroundColor: '#e84393',
                pointRadius: 6,
                pointHoverRadius: 10
            },
            {
                label: 'æ­£å¸¸ä¸Šé™',
                data: new Array(bmiLabels.length).fill(17.5),
                borderColor: '#2ecc71',
                borderWidth: 2,
                borderDash: [5, 5],
                pointRadius: 0,
                fill: false
            },
            {
                label: 'è¶…é‡è­¦æˆ’çº¿',
                data: new Array(bmiLabels.length).fill(19.5),
                borderColor: '#f39c12',
                borderWidth: 2,
                borderDash: [5, 5],
                pointRadius: 0,
                fill: false
            }
        ], {
            plugins: {
                title: {
                    display: true,
                    text: 'BMIæŒ‡æ•°å˜åŒ–',
                    font: { size: 16 }
                }
            },
            scales: {
                y: {
                    title: {
                        display: true,
                        text: 'BMIæŒ‡æ•°'
                    },
                    min: 15,
                    max: 25
                }
            }
        });

        console.log('å›¾è¡¨åŠ è½½å®Œæˆï¼');
        console.log('æœå†»è®°å½•æ•°:', guodongProcessed.length);
        console.log('å“†å’ªè®°å½•æ•°:', duomiProcessed.length);
    </script>
</body>
</html>